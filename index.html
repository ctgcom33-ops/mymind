<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶™‡¶£‡ßç‡¶Ø ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶ì ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ (‡¶ö‡ßÇ‡¶°‡¶º‡¶æ‡¶®‡ßç‡¶§ ‡¶∏‡¶Ç‡¶∏‡ßç‡¶ï‡¶∞‡¶£)</title>
    
    <style>
        /* --- CSS ‡¶ï‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ --- */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f8f9fa;
            padding: 20px;
        }
        .main-content {
            display: flex; 
            gap: 20px;
            max-width: 1200px;
            margin: 20px auto;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .form-container {
            flex: 2; 
            max-width: 600px;
        }
        /* ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶á‡¶®‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        .summary-container {
            flex: 1; 
            max-width: 300px;
            position: sticky; 
            top: 20px;
            align-self: flex-start;
            border: 1px solid #ddd;
            padding: 15px;
            transition: opacity 0.5s ease; 
        }
        /* *‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£:* ‡¶è‡¶ü‡¶ø ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã‡¶∞ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        .summary-container.hidden {
            display: none !important; /* ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§‡¶≠‡¶æ‡¶¨‡ßá ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø !important ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
            opacity: 0;
        }
        
        .summary-container.visible {
            display: block !important;
            opacity: 1;
        }
        
        h2, h3 {
            color: #343a40;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        /* ‡¶™‡ßç‡¶∞‡ßã‡¶ó‡ßç‡¶∞‡ßá‡¶∏ ‡¶¨‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        .progress-container {
            width: 100%;
            background-color: #e9ecef;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .progress-bar {
            height: 15px;
            background-color: #007bff;
            border-radius: 5px;
            width: 0%;
            transition: width 0.4s ease-in-out;
        }

        .form-group {
            margin-bottom: 15px;
            display: none; 
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.5s ease;
            position: relative;
        }
        .form-group.active {
            display: flex;
            opacity: 1;
        }
        
        .step-counter {
            text-align: right;
            font-size: 14px;
            font-weight: 600;
            color: #6c757d;
            margin-top: -10px;
            margin-bottom: 5px;
        }

        label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #495057;
        }
        input[type="text"],
        input[type="number"],
        input[type="date"],
        select {
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            margin-top: 15px;
        }
        .nav-btn {
            flex-grow: 1;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .nav-btn.next-btn {
            background-color: #28a745; 
            color: white;
        }
        .nav-btn.back-btn {
            background-color: #6c757d; 
            color: white;
        }
        
        .save-button-group .save-button {
            background-color: #007bff;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 18px;
            width: 100%;
            margin-top: 20px;
            transition: background-color 0.3s;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px dashed #eee;
            font-size: 14px;
        }
        .summary-item strong {
            color: #343a40;
        }
        .summary-item .warning {
            color: #ffc107;
            font-style: italic;
        }

        /* --- ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ --- */
        .filter-section {
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            display: flex;
            flex-wrap: wrap; 
            gap: 8px; 
            align-items: center;
        }
        .filter-section label {
            font-weight: 600;
            color: #343a40;
            margin-right: 5px;
        }
        .filter-button {
            padding: 8px 12px;
            border: 1px solid #007bff;
            background-color: white;
            color: #007bff;
            border-radius: 20px; 
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s, color 0.2s;
        }
        .filter-button.active {
            background-color: #007bff; 
            color: white;
            border-color: #007bff;
            font-weight: 600;
        }
        .filter-button:hover:not(.active) {
            background-color: #e9ecef;
        }
        /* --- CSS ‡¶ï‡ßã‡¶° ‡¶∂‡ßá‡¶∑ --- */
    </style>
</head>
<body>

<div class="main-content">
    
    <div class="container form-container">
        <h2>‡¶™‡¶£‡ßç‡¶Ø ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶´‡¶∞‡ßç‡¶Æ üìù (‡¶ß‡¶æ‡¶™‡ßá ‡¶ß‡¶æ‡¶™‡ßá)</h2>
        
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        
        <form id="productEntryForm">
            
            <div class="form-group" data-step="1">
                <div class="step-counter" id="stepCounter1"></div>
                <label for="product_name">‡ßß. ‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ: <span style="color:red;">*</span></label>
                <input type="text" id="product_name" name="product_name" required oninput="updateSummary()">
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" disabled>‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" onclick="checkRequiredFields(1)">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‚Üí</button>
                </div>
            </div>

            <div class="form-group" data-step="2">
                <div class="step-counter" id="stepCounter2"></div>
                <label for="category">‡ß®. ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø: <span style="color:red;">*</span></label>
                <select id="category" name="category" required onchange="handleCategoryChange(); updateSummary();">
                    <option value="">‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                    <option value="‡¶Æ‡ßÅ‡¶¶‡¶ø/‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞">‡¶Æ‡ßÅ‡¶¶‡¶ø/‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞</option>
                    <option value="‡¶á‡¶≤‡ßá‡¶ï‡¶ü‡ßç‡¶∞‡¶®‡¶ø‡¶ï‡ßç‡¶∏">‡¶á‡¶≤‡ßá‡¶ï‡¶ü‡ßç‡¶∞‡¶®‡¶ø‡¶ï‡ßç‡¶∏</option>
                    <option value="‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø">‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø (‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®)</option>
                </select>
                
                <div id="otherCategoryInput" style="margin-top: 10px; display: none;">
                    <label for="custom_category">‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ:</label>
                    <input type="text" id="custom_category" name="custom_category" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" oninput="updateSummary()">
                </div>
                
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" onclick="navigateForm(-1)">‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" onclick="checkRequiredFields(1)">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‚Üí</button>
                </div>
            </div>

            <div class="form-group" data-step="3">
                <div class="step-counter" id="stepCounter3"></div>
                <label for="unit_type">‡ß©. ‡¶è‡¶ï‡¶ï: <span style="color:red;">*</span></label>
                <select id="unit_type" name="unit_type" required onchange="updateSummary()">
                    <option value="‡¶™‡¶ø‡¶∏">‡¶™‡¶ø‡¶∏ (Piece)</option>
                    <option value="‡¶ï‡ßá‡¶ú‡¶ø">‡¶ï‡ßá‡¶ú‡¶ø (KG)</option>
                </select>
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" onclick="navigateForm(-1)">‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" onclick="checkRequiredFields(1)">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‚Üí</button>
                </diV>
            </div>
            
            <div class="form-group" data-step="4">
                <div class="step-counter" id="stepCounter4"></div>
                <label for="total_quantity">‡ß™. ‡¶Æ‡ßã‡¶ü ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡¶ï‡ßá‡¶ú‡¶ø/‡¶™‡¶ø‡¶∏): <span style="color:red;">*</span></label>
                <input type="number" id="total_quantity" name="total_quantity" step="any" min="0" required oninput="updateSummary(); calculatePurchasePrice();">
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" onclick="navigateForm(-1)">‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" onclick="checkRequiredFields(1)">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‚Üí</button>
                </div>
            </div>

            <div class="form-group" data-step="5">
                <div class="step-counter" id="stepCounter5"></div>
                <label for="total_cost">‡ß´. ‡¶Æ‡ßã‡¶ü ‡¶ï‡ßç‡¶∞‡ßü‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø (‡¶ü‡¶æ‡¶ï‡¶æ): <span style="color:red;">*</span></label>
                <input type="number" id="total_cost" name="total_cost" step="0.01" min="0" required oninput="updateSummary(); calculatePurchasePrice();">
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" onclick="navigateForm(-1)">‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" onclick="checkRequiredFields(1)">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‚Üí</button>
                </div>
            </div>
            
            <div class="form-group" data-step="6">
                <div class="step-counter" id="stepCounter6"></div>
                <label for="expense">‡ß¨. ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ñ‡¶∞‡¶ö (‡¶™‡¶∞‡¶ø‡¶¨‡¶π‡¶®, ‡¶á‡¶§‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø):</label>
                <input type="number" id="expense" name="expense" step="0.01" value="0" oninput="updateSummary(); calculatePurchasePrice();">
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" onclick="navigateForm(-1)">‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" onclick="checkRequiredFields(1)">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‚Üí</button>
                </div>
            </div>

            <div class="form-group" data-step="7">
                <div class="step-counter" id="stepCounter7"></div>
                <label for="purchase_price_per_unit">‡ß≠. ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶è‡¶ï‡¶ï ‡¶ï‡ßç‡¶∞‡ßü‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø (‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º):</label>
                <input type="text" id="purchase_price_per_unit" name="purchase_price_per_unit" readonly placeholder="‡¶Æ‡ßã‡¶ü ‡¶ü‡¶æ‡¶ï‡¶æ / ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£">
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" onclick="navigateForm(-1)">‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" onclick="checkRequiredFields(1)">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‚Üí</button>
                </div>
            </div>
            
            <div class="form-group" data-step="8">
                <div class="step-counter" id="stepCounter8"></div>
                <label for="selling_price">‡ßÆ. ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶è‡¶ï‡¶ï ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶Ø‡¶º‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø (‡¶ü‡¶æ‡¶ï‡¶æ): <span style="color:red;">*</span></label>
                <input type="number" id="selling_price" name="selling_price" step="0.01" min="0" required oninput="updateSummary()">
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" onclick="navigateForm(-1)">‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" onclick="checkRequiredFields(1)">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‚Üí</button>
                </div>
            </div>

            <div class="form-group" data-step="9">
                <div class="step-counter" id="stepCounter9"></div>
                <label for="expiry_date">‡ßØ. ‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶Æ‡ßá‡¶Ø‡¶º‡¶æ‡¶¶ (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï):</label>
                <input type="date" id="expiry_date" name="expiry_date" onchange="updateSummary()">
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" onclick="navigateForm(-1)">‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" onclick="checkRequiredFields(1)">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‚Üí</button>
                </div>
            </div>
            
            <div class="form-group" data-step="10">
                <div class="step-counter" id="stepCounter10"></div>
                <label for="company_name">‡ßß‡ß¶. ‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï):</label>
                <input type="text" id="company_name" name="company_name" oninput="updateSummary()">
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" onclick="navigateForm(-1)">‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" onclick="checkRequiredFields(1)">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‚Üí</button>
                </div>
            </div>
            
            <div class="form-group" data-step="11">
                <div class="step-counter" id="stepCounter11"></div>
                <label for="seller_name">‡ßß‡ßß. ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡ßá‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï):</label>
                <input type="text" id="seller_name" name="seller_name" oninput="updateSummary()">
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" onclick="navigateForm(-1)">‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" onclick="checkRequiredFields(1)">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‚Üí</button>
                </div>
            </div>
            
            <div class="form-group" data-step="12">
                <div class="step-counter" id="stepCounter12"></div>
                <label for="seller_mobile">‡ßß‡ß®. ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡ßá‡¶§‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Ç (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï):</label>
                <input type="text" id="seller_mobile" name="seller_mobile" oninput="updateSummary()">
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" onclick="navigateForm(-1)">‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" onclick="document.querySelector('.save-button').click()">‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ì ‡¶∏‡ßá‡¶≠ ‚Üí</button>
                </div>
            </div>
            
            <div class="form-group save-button-group" data-step="13">
                <div class="step-counter" id="stepCounter13"></div>
                <button type="submit" class="save-button">
                    ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶ì ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶® ‚úÖ
                </button>
                <div class="navigation-buttons">
                    <button type="button" class="nav-btn back-btn" onclick="navigateForm(-1)">‚Üê ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ</button>
                    <button type="button" class="nav-btn next-btn" disabled>‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶π‡ßü‡ßá‡¶õ‡ßá</button>
                </div>
            </div>
            
        </form>
    </div>

    <div class="container summary-container hidden" id="summaryContainer" style="display:none;">
        <h3>‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ üìã</h3>
        <div id="entrySummary">
            <p style="color: #6c757d; font-style: italic;">‡¶ß‡¶æ‡¶™‡ßá ‡¶ß‡¶æ‡¶™‡ßá ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá‡•§</p>
        </div>
    </div>
</div>

<div class="container list-container" id="productListContainer" style="margin-top: 30px;">
    
    <h3>‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§ ‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ üìã</h3>

    <div class="filter-section">
        <label>‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞:</label>
        <div id="categoryFilterButtons">
            </div>
    </div>
    
    <div id="productTableContainer">
        </div>
</div>

<script>
    /* --- JavaScript ‡¶ï‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ --- */
    const form = document.getElementById('productEntryForm');
    const productListContainer = document.getElementById('productTableContainer');
    const progressBar = document.getElementById('progressBar');
    const entrySummary = document.getElementById('entrySummary'); 
    const summaryContainer = document.getElementById('summaryContainer'); 
    const categoryFilterButtons = document.getElementById('categoryFilterButtons'); 
    const otherCategoryInput = document.getElementById('otherCategoryInput'); // ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶á‡¶®‡¶æ‡¶∞
    
    const formGroups = Array.from(form.querySelectorAll('.form-group'));
    const totalSteps = formGroups.length;
    const activeSteps = totalSteps - 1; 
    let currentStep = 0; 
    let activeFilter = 'all'; 

    const fieldMap = {
        'product_name': '‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ',
        'category': '‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø',
        'unit_type': '‡¶è‡¶ï‡¶ï',
        'total_quantity': '‡¶Æ‡ßã‡¶ü ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£',
        'total_cost': '‡¶Æ‡ßã‡¶ü ‡¶ï‡ßç‡¶∞‡ßü‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø',
        'expense': '‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ñ‡¶∞‡¶ö',
        'purchase_price_per_unit': '‡¶è‡¶ï‡¶ï ‡¶ï‡ßç‡¶∞‡ßü‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø',
        'selling_price': '‡¶è‡¶ï‡¶ï ‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡¶Ø‡¶º‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø',
        'expiry_date': '‡¶Æ‡ßá‡¶Ø‡¶º‡¶æ‡¶¶',
        'company_name': '‡¶ï‡ßã‡¶Æ‡ßç‡¶™‡¶æ‡¶®‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ',
        'seller_name': '‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡ßá‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ',
        'seller_mobile': '‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡ßá‡¶§‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤'
    };

    // ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function showSummary() {
        summaryContainer.classList.remove('hidden');
        summaryContainer.classList.add('visible');
        summaryContainer.style.display = 'block';
    }
    
    // ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function hideSummary() {
        summaryContainer.classList.remove('visible');
        summaryContainer.classList.add('hidden');
        summaryContainer.style.display = 'none';
    }
    
    // ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶π‡¶≤‡ßá "‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø" ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶´‡¶ø‡¶≤‡ßç‡¶°‡¶ü‡¶ø ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã/‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã
    window.handleCategoryChange = function() {
        const categorySelect = document.getElementById('category');
        const customCategoryInput = document.getElementById('custom_category');

        if (categorySelect.value === '‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø') {
            otherCategoryInput.style.display = 'block';
            customCategoryInput.setAttribute('required', 'required');
            customCategoryInput.focus();
        } else {
            otherCategoryInput.style.display = 'none';
            customCategoryInput.removeAttribute('required');
            customCategoryInput.value = ''; // ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶®‡¶æ‡¶Æ ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ
        }
    }


    // ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
    window.checkRequiredFields = function(direction) {
        showSummary(); // ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ 
        
        const currentGroup = formGroups[currentStep];
        const requiredInputs = currentGroup.querySelectorAll('[required]:not([readonly])');
        let allValid = true;
        
        // *‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶ö‡ßá‡¶ï: ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ*
        if (currentStep === 1 && document.getElementById('category').value === '‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø') {
            const customCategoryInput = document.getElementById('custom_category');
            if (!customCategoryInput.value.trim()) {
                allValid = false;
                customCategoryInput.style.border = '2px solid red';
            } else {
                customCategoryInput.style.border = '1px solid #ced4da';
            }
        }
        
        requiredInputs.forEach(input => {
            if (!input.value || (input.tagName === 'SELECT' && input.value === "")) {
                allValid = false;
                input.style.border = '2px solid red';
            } else {
                input.style.border = '1px solid #ced4da';
            }
        });

        if (allValid) {
            navigateForm(direction);
        } else {
            alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá * ‡¶ö‡¶ø‡¶π‡ßç‡¶®‡¶ø‡¶§ ‡¶Ü‡¶¨‡¶∂‡ßç‡¶Ø‡¶ø‡¶ï ‡¶ï‡ßç‡¶∑‡ßá‡¶§‡ßç‡¶∞‡¶ü‡¶ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
            // ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶®‡¶æ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶π‡¶≤‡ßá ‡¶∏‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶´‡ßã‡¶ï‡¶æ‡¶∏ ‡¶ï‡¶∞‡¶æ
            if (currentStep === 1 && document.getElementById('category').value === '‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø' && !document.getElementById('custom_category').value.trim()) {
                 document.getElementById('custom_category').focus();
            } else {
                 currentGroup.querySelector('[required]:not([readonly])').focus();
            }
        }
    }


    window.updateSummary = function() {
        showSummary(); // ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶¶‡ßá‡¶ì‡ßü‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ

        let html = '';
        const formData = new FormData(form);
        const data = {};
        for (const [key, value] of formData.entries()) {
            data[key] = value;
        }
        
        data['purchase_price_per_unit'] = document.getElementById('purchase_price_per_unit').value;
        
        // *‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø‡¶∞ ‡¶Æ‡¶æ‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ*
        const customCategoryValue = document.getElementById('custom_category') ? document.getElementById('custom_category').value.trim() : '';
        if (data['category'] === '‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø' && customCategoryValue) {
             data['category'] = customCategoryValue; 
        }

        for (const [id, label] of Object.entries(fieldMap)) {
            let value = data[id] || '';
            let unit = '';

            if (id === 'total_quantity') {
                unit = document.getElementById('unit_type').value;
            } else if (id.includes('price') || id.includes('cost') || id.includes('expense')) {
                unit = ' ‡¶ü‡¶æ‡¶ï‡¶æ';
            }
            
            const element = document.getElementById(id);
            const isRequired = element ? element.hasAttribute('required') : false;
            
            let displayValue;
            if (value && value !== '0') {
                displayValue = `<span style="color: #007bff;">${value}${unit}</span>`;
            } else if (isRequired) {
                displayValue = `<span class="warning">‡¶Ü‡¶¨‡¶∂‡ßç‡¶Ø‡¶ø‡¶ï, ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø</span>`;
            } else if (value === '0' || !value) {
                displayValue = `<span class="warning">N/A</span>`;
            }

            html += `
                <div class="summary-item">
                    <strong>${label}:</strong>
                    ${displayValue}
                </div>
            `;
        }

        entrySummary.innerHTML = html;
    }


    function updateProgress() {
        const percentage = (currentStep / activeSteps) * 100; 
        progressBar.style.width = Math.min(percentage, 100).toFixed(2) + '%';
        
        formGroups.forEach((group, index) => {
            const stepNumber = index + 1;
            const counterElement = group.querySelector('.step-counter');
            if (counterElement) {
                if (stepNumber <= activeSteps) {
                    counterElement.textContent = `‡¶ß‡¶æ‡¶™ ${stepNumber}/${activeSteps}`; 
                } else {
                    counterElement.textContent = '‡¶´‡¶ø‡¶®‡¶ø‡¶∂';
                }
            }
        });
    }

    // ‡¶®‡ßá‡¶ï‡ßç‡¶∏‡¶ü/‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï ‡¶¨‡¶æ‡¶ü‡¶® ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
    window.navigateForm = function(direction) {
        showSummary(); // ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ ‡¶¶‡ßÉ‡¶∂‡ßç‡¶Ø‡¶Æ‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ 

        formGroups[currentStep].classList.remove('active');

        currentStep += direction;

        if (currentStep < 0) {
            currentStep = 0; 
        } else if (currentStep >= totalSteps) {
            currentStep = totalSteps - 1; 
        }
        
        formGroups[currentStep].classList.add('active');

        const currentInput = formGroups[currentStep].querySelector('input:not([readonly]), select, .save-button');
        if (currentInput) {
            currentInput.focus();
        }
        
        if (currentInput && ['total_quantity', 'total_cost', 'expense'].includes(currentInput.id)) {
             calculatePurchasePrice();
        }
        
        updateSummary(); 
        updateProgress();
    }

    // Enter ‡¶ö‡¶æ‡¶™‡¶≤‡ßá ‡¶®‡ßá‡¶≠‡¶ø‡¶ó‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
    function setupSequentialNavigation() {
        const allInputs = Array.from(form.querySelectorAll('input:not([type="submit"]), select'));
        
        allInputs.forEach((input) => {
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    
                    const inputGroup = input.closest('.form-group');
                    const groupIndex = formGroups.indexOf(inputGroup);

                    if (input.hasAttribute('readonly')) {
                         navigateForm(1);
                         return;
                    }
                    
                    if (groupIndex === totalSteps - 2) { 
                        document.querySelector('.save-button').click();
                    } else if (groupIndex !== -1 && groupIndex < totalSteps - 1) {
                        checkRequiredFields(1); 
                    }
                }
            });
        });

        if (totalSteps > 0) {
            formGroups[0].classList.add('active');
            document.getElementById('product_name').focus();
        }
        updateProgress();
        updateSummary(); 
    }

    // ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶è‡¶ï‡¶ï ‡¶ï‡ßç‡¶∞‡¶Ø‡¶º‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡¶ó‡¶£‡¶®‡¶æ
    function calculatePurchasePrice() {
        const totalQuantity = document.getElementById('total_quantity');
        const totalCost = document.getElementById('total_cost');
        const expense = document.getElementById('expense');
        const purchasePricePerUnit = document.getElementById('purchase_price_per_unit');

        const quantity = parseFloat(totalQuantity.value) || 0;
        const cost = parseFloat(totalCost.value) || 0;
        const extraExpense = parseFloat(expense.value) || 0;
        
        if (quantity > 0) {
            const totalAmount = cost + extraExpense;
            const pricePerUnit = totalAmount / quantity;
            purchasePricePerUnit.value = pricePerUnit.toFixed(2);
        } else {
            purchasePricePerUnit.value = '‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡ß¶ ‡¶¨‡¶æ ‡¶ñ‡¶æ‡¶≤‡¶ø';
        }
        updateSummary();
    }

    function getProducts() {
        return JSON.parse(localStorage.getItem('products')) || [];
    }
    
    // ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶® ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ 
    function populateCategoryFilter() {
        const products = getProducts();
        const categories = new Set(products.map(p => p.category).filter(c => c)); 
        
        categoryFilterButtons.innerHTML = '';
        
        // ‡ßß. ‡¶∏‡¶ï‡¶≤ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶¨‡¶æ‡¶ü‡¶®
        const allButton = document.createElement('button');
        allButton.textContent = '‡¶∏‡¶ï‡¶≤ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø';
        allButton.classList.add('filter-button');
        allButton.setAttribute('data-category', 'all');
        allButton.classList.toggle('active', activeFilter === 'all');
        allButton.onclick = () => setFilter('all');
        categoryFilterButtons.appendChild(allButton);

        // ‡ß®. ‡¶∏‡ßç‡¶¨‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶¨‡¶æ‡¶ü‡¶®
        categories.forEach(category => {
            const button = document.createElement('button');
            button.textContent = category;
            button.classList.add('filter-button');
            button.setAttribute('data-category', category);
            button.classList.toggle('active', activeFilter === category);
            button.onclick = () => setFilter(category);
            categoryFilterButtons.appendChild(button);
        });
    }
    
    // ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ 
    window.setFilter = function(category) {
        activeFilter = category;
        // ‡¶∏‡¶ï‡¶≤ ‡¶¨‡¶æ‡¶ü‡¶® ‡¶•‡ßá‡¶ï‡ßá active ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶∏‡¶∞‡¶ø‡ßü‡ßá ‡¶´‡ßá‡¶≤‡¶æ
        document.querySelectorAll('.filter-button').forEach(btn => btn.classList.remove('active'));
        // ‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶¨‡¶æ‡¶ü‡¶®‡ßá active ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ
        document.querySelector(`.filter-button[data-category="${category}"]`).classList.add('active');
        
        displayProductList(getProducts());
    }


    window.deleteProduct = function(idToDelete, productName) {
        
        const confirmationText = prompt(`‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø "${productName}" ‡¶®‡¶æ‡¶Æ‡¶ü‡¶ø ‡¶π‡ßÅ‡¶¨‡¶π‡ßÅ ‡¶®‡¶ø‡¶ö‡ßá ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®:`);

        if (confirmationText === null || confirmationText.trim() !== productName.trim()) {
            if (confirmationText !== null) {
                alert(`‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§, ‡¶≤‡ßá‡¶ñ‡¶æ ‡¶®‡¶æ‡¶Æ‡¶ü‡¶ø ("${confirmationText}") ‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ("${productName}") ‡¶Æ‡ßá‡¶≤‡ßá‡¶®‡¶ø‡•§ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ ‡¶π‡¶≤‡ßã ‡¶®‡¶æ‡•§`);
            }
            return;
        }

        let products = getProducts();
        products = products.filter(p => p.id !== idToDelete);
        localStorage.setItem('products', JSON.stringify(products));
        
        populateCategoryFilter(); 
        displayProductList(products); 
        alert(`‡¶™‡¶£‡ßç‡¶Ø "${productName}" ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§`);
    }

    form.addEventListener('submit', function(event) {
        event.preventDefault(); 
        calculatePurchasePrice(); 
        
        if (isNaN(parseFloat(document.getElementById('purchase_price_per_unit').value))) {
            alert('‡¶Æ‡ßã‡¶ü ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶ì ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
            return;
        }
        
        // *‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶Æ‡¶æ‡¶® ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ*
        let finalCategory = document.getElementById('category').value;
        const customCategoryInput = document.getElementById('custom_category');
        const customCategoryValue = customCategoryInput.value.trim();
        
        if (finalCategory === '‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø' && customCategoryValue) {
            finalCategory = customCategoryValue;
        } else if (finalCategory === '‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø' && !customCategoryValue) {
            alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ‡¶ü‡¶ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
            customCategoryInput.focus();
            return;
        }

        const newProduct = {
            id: Date.now(), 
            name: document.getElementById('product_name').value,
            category: finalCategory, // ‡¶ö‡ßÇ‡¶°‡¶º‡¶æ‡¶®‡ßç‡¶§ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶Æ‡¶æ‡¶®
            unit: document.getElementById('unit_type').value,
            quantity: parseFloat(document.getElementById('total_quantity').value),
            totalCost: parseFloat(document.getElementById('total_cost').value),
            expense: parseFloat(document.getElementById('expense').value) || 0,
            purchasePricePerUnit: parseFloat(document.getElementById('purchase_price_per_unit').value),
            sellingPrice: parseFloat(document.getElementById('selling_price').value),
            expiry: document.getElementById('expiry_date').value,
            company: document.getElementById('company_name').value,
            seller: document.getElementById('seller_name').value,
            mobile: document.getElementById('seller_mobile').value
        };

        const products = getProducts();
        products.push(newProduct);
        localStorage.setItem('products', JSON.stringify(products));

        populateCategoryFilter(); 
        displayProductList(products);
        
        // ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶≠ ‡¶π‡¶ì‡ßü‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ ‡¶≤‡ßÅ‡¶ï‡¶ø‡ßü‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ
        hideSummary();

        form.reset();
        document.getElementById('purchase_price_per_unit').value = '';
        
        // ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã ‡¶ì ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
        otherCategoryInput.style.display = 'none'; 
        customCategoryInput.value = '';

        alert('‡¶™‡¶£‡ßç‡¶Ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
        
        formGroups.forEach(group => group.classList.remove('active'));
        currentStep = 0; 
        formGroups[currentStep].classList.add('active');
        document.getElementById('product_name').focus();
        updateProgress();
        
        updateSummary(); 
    });

    // ‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶® 
    function displayProductList(products = getProducts()) {
        
        const selectedCategory = activeFilter;
        
        // ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞‡¶ø‡¶Ç
        const filteredProducts = selectedCategory === 'all' 
            ? products 
            : products.filter(p => p.category === selectedCategory);
            
        productListContainer.innerHTML = '';

        if (filteredProducts.length === 0) {
            productListContainer.innerHTML = `<p style="padding: 10px; border: 1px dashed #dc3545;">
                ${selectedCategory === 'all' ? '‡¶è‡¶ñ‡¶®‡¶ì ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡¶£‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§' : `"${selectedCategory}" ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø‡¶§‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡¶£‡ßç‡¶Ø ‡¶®‡ßá‡¶á‡•§`}
            </p>`;
            return;
        }

        let html = '<table>';
        html += '<thead><tr><th>‡¶™‡¶£‡ßç‡¶Ø‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ</th><th>‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</th><th>‡¶ï‡ßç‡¶∞‡ßü‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø (‡¶è‡¶ï‡¶ï)</th><th>‡¶¨‡¶ø‡¶ï‡ßç‡¶∞‡ßü‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø (‡¶è‡¶ï‡¶ï)</th><th>‡¶Æ‡ßá‡ßü‡¶æ‡¶¶</th><th>‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</th></tr></thead>';
        html += '<tbody>';

        filteredProducts.forEach(p => {
            html += `<tr>
                <td>${p.name}</td>
                <td>${p.quantity} ${p.unit}</td>
                <td>${p.purchasePricePerUnit ? p.purchasePricePerUnit.toFixed(2) : 'N/A'} ‡¶ü‡¶æ‡¶ï‡¶æ</td>
                <td>${p.sellingPrice ? p.sellingPrice.toFixed(2) : 'N/A'} ‡¶ü‡¶æ‡¶ï‡¶æ</td>
                <td>${p.expiry || 'N/A'}</td>
                <td><button class="delete-btn" onclick="deleteProduct(${p.id}, '${p.name.replace(/'/g, "\\'")}')">‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®</button></td>
            </tr>`;
        });

        html += '</tbody></table>';
        productListContainer.innerHTML = html;
    }

    // ‡¶™‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶∏‡¶¨ ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™ ‡¶ï‡¶∞‡¶æ
    window.onload = function() {
        // ‡¶≤‡ßã‡¶° ‡¶π‡¶ì‡ßü‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶æ‡¶•‡ßá‡¶á ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ ‡¶≤‡ßÅ‡¶ï‡¶ø‡ßü‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ
        hideSummary();
        
        populateCategoryFilter();
        displayProductList();
        setupSequentialNavigation();
        handleCategoryChange(); // ‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶≤‡ßÅ‡¶ï‡¶æ‡¶®‡ßã ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ
    };
    /* --- JavaScript ‡¶ï‡ßã‡¶° ‡¶∂‡ßá‡¶∑ --- */
</script>

</body>
</html>
